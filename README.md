# bibliomap

Bibliomap is a tool for real-time viewing in the browser localised usage events generated by [ezPAARSE](https://github.com/ezpaarse-project/ezpaarse).

How could it be useful ?
  * For real-time monitoring your ezproxy EC consultations 
  * For the fun !

![anim](https://cloud.githubusercontent.com/assets/328244/19802257/11855392-9d03-11e6-9338-e35893ecddfc.gif)

[Demonstration on the CNRS subscribed electronic ressources usage statistics](http://bibliomap.inist.fr/)


Bibliomap uses these softwares:
  * [Log.io](http://logio.org/) for ECs harvesting and for real-time usage events viewing in the browser.
  * [ezpaarse2log.io-harvester](https://github.com/ezpaarse-project/ezpaarse2log.io-harvester) and [ezpaarse2log.io](https://github.com/ezpaarse-project/ezpaarse2log.io) for real-time listening lines of log comming from an ezproxy, creating ezPAARSE jobs to generate corresponding usage event and then sending it all to bibliomap

<p align="center">
<img src="https://docs.google.com/drawings/d/1bkxEEBL1kLzH76dkIYFzspYHOVajDjQHCijU3mxJLnM/pub?w=694&h=519" />
</p>

## Prerequisites

  * Docker and docker-compose
  * You already have installed [ezpaarse2log.io-harvester](https://github.com/ezpaarse-project/ezpaarse2log.io-harvester) monitoring your ezproxy log files
  * You already have installed [ezpaarse2log.io](https://github.com/ezpaarse-project/ezpaarse2log.io) listening for ezpaarse2log.io-harvester data, sending it to ezpaarse and sending the result to you this bibliomap

## Installation

You can install bibliomap on the same server than [ezpaarse2log.io](https://github.com/ezpaarse-project/ezpaarse2log.io).
 
 TODO

## Configuration

```javascript
var defaultConfig = {
  debug: false,
  index: 'index-cnrs.html',
  bibliomap: {
  	host: '127.0.0.1',
  	port: '50197',
  	js: 'bibliomap-cnrs.js'
  },
  listen: {
    // listen for harvested logs
    ezpaarse2logio: {
      host: '127.0.0.1',  // adjust where log-io.harvester is located
      port: 28779         // this is the default log.io-harvester destination port
    }
  }
};
```


To overload config, create a config.local.js file.

Example for bibliomap for Universite de Lorraine :
```bash
echo "module.exports = {
// sample local config : adjust to your needs
  debug: false,
  index: 'index-ul.html',       // change index page to your needs
  bibliomap: {
  	host: '127.0.0.1',
  	port: '50197',
  	js: 'bibliomap-ul.js'  // change bibliomap script name to custom one if needed
  }
};" > ./config.local.js
```

Then open your browser and go to http://bibliomap-ip:50197/ and you will have the nice Bibliomap interface displayed.

<p align="center">
<img width="500" src="https://raw.githubusercontent.com/ezpaarse-project/bibliomap/master/public/images/ezPAARSE-SR23-bibliomap-cnrs-02.jpg" alt="Running Bibliomap screenshot" />
</p>

## Running Bibliomap

### Start, Status, Stop

TODO